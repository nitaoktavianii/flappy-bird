Name: Deploy-Flappy-Bird
SchemaVersion: 1.0

Triggers:
  - Type: Push
    Branches:
      - main

Actions:
  Build:
    Identifier: aws/build@v1
    Inputs:
      Sources:
        - WorkflowSource
    Configuration:
      Steps:
        - Run: echo "Building Flappy Bird game..."
        - Run: mkdir -p dist
        - Run: cp index.html style.css main.js dist/
    Outputs:
      Artifacts:
        - Name: buildOutput
          Files:
            - dist/**

  Deploy:
    Identifier: aws/build@v1
    Inputs:
      Artifacts:
        - buildOutput
    Configuration:
      Steps:
        - Run: echo "Deploying to S3..."
        - Run: aws s3 sync dist s3://nita-flappybird-demo --delete
    Environment:
      Name: FlappyEnv
      Connections:
        - Name: "022717055444"   # AWS Account ID kamu
          Role: "CodeCatalystWorkflowDevelopmentRole-demo-app1"
